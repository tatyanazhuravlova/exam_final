{"version":3,"sources":["script.js"],"names":["docReady","searchHandler","event","value","input","getImages","encodeURIComponent","query","xhr","method","q","undefined","orientation","amount","XMLHttpRequest","XDomainRequest","url","open","onload","data","JSON","parse","responseText","e","emptyGrid","grid","innerHTML","style","height","hits","length","renderGrid","map","prepareData","initMasonry","send","Masonry","columnWidth","itemSelector","percentPosition","gutter","item","orient","webformatHeight","webformatWidth","text","tags","webformatURL","dataImages","elem","sizer","document","createElement","className","appendChild","i","max","img","backgroundImage","carousels","querySelectorAll","flicks","forEach","call","Flickity","prevNextButtons","autoPlay","wrapAround","contain","cellSelector","pageDots","nav","addEventListener","next","attachEvent","previous","searchBtnListener","querySelector","button"],"mappings":"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","file":"script.js","sourcesContent":["'use strict';\ndocReady(function() {\n\n// carousels init\nvar carousels = document.querySelectorAll('.carousel');\nvar flicks = [];\n\n[].forEach.call(carousels, function(item, i) {\n  flicks[i] = new Flickity(item, {\n    prevNextButtons: false,\n    autoPlay: true,\n    wrapAround: true,\n    contain: true,\n    cellSelector: '.carousel__cell',\n    pageDots: false,\n  });\n\n  var nav = item.querySelectorAll('.carousel__nav');\n\n  if (item.addEventListener) {\n    nav[0].addEventListener('click', function() {\n      flicks[i].next();\n    });\n  } else {\n    nav[0].attachEvent(\"onclick\", function() {\n      flicks[i].next();\n    });\n  }\n\n  if (item.addEventListener) {\n    nav[1].addEventListener('click', function() {\n      flicks[i].previous();\n    });\n  } else {\n    nav[1].attachEvent(\"onclick\", function() {\n      flicks[i].previous();\n    });\n  }\n\n});\n\nvar grid    = document.querySelector('.grid'),\n    input   = document.querySelectorAll('.search-block__input')[0],\n    button  = document.querySelectorAll('.search-block__btn')[0],\n    searchBtnListener;\n\nif (button.addEventListener) {\n  searchBtnListener = button.addEventListener('click', searchHandler);\n} else {\n  searchBtnListener = button.attachEvent(\"onclick\", searchHandler);\n}\n\nfunction searchHandler(event) {\n  var value = input.value;\n  if (value) {\n    getImages(encodeURIComponent(value));\n  }\n};\n\nfunction getImages(query) {\n  var xhr,\n      q = (query === undefined) ? '' : query,\n      orientation = 'all',\n      amount = 7,\n      method;\n\n  if(\"onload\" in new XMLHttpRequest()) {\n    xhr = new XMLHttpRequest();\n    method = 'https://'\n  } else {\n    xhr = new XDomainRequest();\n    method = 'http://'\n  }\n\n  var url = method +\n      'pixabay.com/api/?key=3650660-4488e4e0e00637d736b251941' +\n      '&q=' + q +\n      '&orientation=' + orientation +\n      '&per_page=' + amount +\n      '&image_type=photo&pretty=true';\n\n  xhr.open('GET', url);\n  xhr.onload = function() {\n    var data;\n\n    try {\n      data = JSON.parse(xhr.responseText);\n    }\n    catch(e) {\n      emptyGrid();\n      grid.innerHTML = '<h2 class=\"content__title--partners\">Server error</h2>';\n      grid.style.height = '50px';\n      return;\n    }\n\n    if (data.hits.length < 7) {\n      emptyGrid();\n      grid.innerHTML = '<h2 class=\"content__title--partners\">Not found</h2>';\n      grid.style.height = '50px';\n      return;\n    }\n\n    emptyGrid();\n    // pick necessary data and render it\n    renderGrid(data.hits.map(prepareData));\n\n    initMasonry();\n\n  }\n\n  xhr.send();\n}\n\n/**\n *\n * Functions\n *\n */\n\nfunction initMasonry() {\n  var msnry = new Masonry(grid, {\n      columnWidth: '.grid__sizer',\n      itemSelector: '.grid__item',\n      percentPosition: true,\n      gutter: 0\n  });\n}\n\n// callback for map\nfunction prepareData(item) {\n  var orient;\n\n  if (item.webformatHeight > item.webformatWidth) {\n    orient = 'vertical';\n  } else if (item.webformatWidth / item.webformatHeight > 1.6) {\n    orient = 'horizontal';\n  } else {\n    orient = 'polaroid';\n  }\n\n  return {\n    text: item.tags,\n    orientation: orient,\n    url: item.webformatURL};\n}\n\nfunction emptyGrid() {\n  grid.innerHTML = '';\n}\n\nfunction renderGrid(dataImages) {\n  var elem;\n\n  var sizer = document.createElement('div');\n  sizer.className = 'grid__sizer';\n  grid.appendChild(sizer);\n\n  for (var i = 0, max = dataImages.length; i < max; i++) {\n    elem = document.createElement('div');\n    var img = document.createElement('div');\n    var text = document.createElement('span');\n\n    switch (dataImages[i].orientation) {\n      case 'vertical':\n        elem.className = 'grid__item grid__item--height2';\n        break;\n      case 'horizontal':\n        elem.className = 'grid__item grid__item--width2';\n        break;\n      case 'polaroid':\n        elem.className = 'grid__item';\n        break;\n      default:\n        elem.className = 'grid__item';\n    }\n\n    img.style.backgroundImage = 'url(\"' + dataImages[i].url + '\")';\n    img.className = 'grid__img';\n    elem.appendChild(img);\n\n    text.innerHTML = dataImages[i].text;\n    text.className = 'grid__title';\n    elem.appendChild(text);\n    grid.appendChild(elem);\n  }\n}\n\ngetImages();\n\n\n});\n"],"sourceRoot":"/source/"}
